
#define R(A,B,C,D,E,F,K,M) E += rotl(A, 5) + F(B, C, D) + K + M; B = rotl(B, 30)

R(a, b, c, d, e, F1, K1, buf[0]);
R(e, a, b, c, d, F1, K1, buf[1]);
R(d, e, a, b, c, F1, K1, buf[2]);
R(c, d, e, a, b, F1, K1, buf[3]);
R(b, c, d, e, a, F1, K1, buf[4]);
R(a, b, c, d, e, F1, K1, buf[5]);
R(e, a, b, c, d, F1, K1, buf[6]);
R(d, e, a, b, c, F1, K1, buf[7]);
R(c, d, e, a, b, F1, K1, buf[8]);
R(b, c, d, e, a, F1, K1, buf[9]);
R(a, b, c, d, e, F1, K1, buf[10]);
R(e, a, b, c, d, F1, K1, buf[11]);
R(d, e, a, b, c, F1, K1, buf[12]);
R(c, d, e, a, b, F1, K1, buf[13]);
R(b, c, d, e, a, F1, K1, buf[14]);
R(a, b, c, d, e, F1, K1, buf[15]);
R(e, a, b, c, d, F1, K1, M(x, 16));
R(d, e, a, b, c, F1, K1, M(x, 17));
R(c, d, e, a, b, F1, K1, M(x, 18));
R(b, c, d, e, a, F1, K1, M(x, 19));
R(a, b, c, d, e, F2, K2, M(x, 20));
R(e, a, b, c, d, F2, K2, M(x, 21));
R(d, e, a, b, c, F2, K2, M(x, 22));
R(c, d, e, a, b, F2, K2, M(x, 23));
R(b, c, d, e, a, F2, K2, M(x, 24));
R(a, b, c, d, e, F2, K2, M(x, 25));
R(e, a, b, c, d, F2, K2, M(x, 26));
R(d, e, a, b, c, F2, K2, M(x, 27));
R(c, d, e, a, b, F2, K2, M(x, 28));
R(b, c, d, e, a, F2, K2, M(x, 29));
R(a, b, c, d, e, F2, K2, M(x, 30));
R(e, a, b, c, d, F2, K2, M(x, 31));
R(d, e, a, b, c, F2, K2, M(x, 32));
R(c, d, e, a, b, F2, K2, M(x, 33));
R(b, c, d, e, a, F2, K2, M(x, 34));
R(a, b, c, d, e, F2, K2, M(x, 35));
R(e, a, b, c, d, F2, K2, M(x, 36));
R(d, e, a, b, c, F2, K2, M(x, 37));
R(c, d, e, a, b, F2, K2, M(x, 38));
R(b, c, d, e, a, F2, K2, M(x, 39));
R(a, b, c, d, e, F3, K3, M(x, 40));
R(e, a, b, c, d, F3, K3, M(x, 41));
R(d, e, a, b, c, F3, K3, M(x, 42));
R(c, d, e, a, b, F3, K3, M(x, 43));
R(b, c, d, e, a, F3, K3, M(x, 44));
R(a, b, c, d, e, F3, K3, M(x, 45));
R(e, a, b, c, d, F3, K3, M(x, 46));
R(d, e, a, b, c, F3, K3, M(x, 47));
R(c, d, e, a, b, F3, K3, M(x, 48));
R(b, c, d, e, a, F3, K3, M(x, 49));
R(a, b, c, d, e, F3, K3, M(x, 50));
R(e, a, b, c, d, F3, K3, M(x, 51));
R(d, e, a, b, c, F3, K3, M(x, 52));
R(c, d, e, a, b, F3, K3, M(x, 53));
R(b, c, d, e, a, F3, K3, M(x, 54));
R(a, b, c, d, e, F3, K3, M(x, 55));
R(e, a, b, c, d, F3, K3, M(x, 56));
R(d, e, a, b, c, F3, K3, M(x, 57));
R(c, d, e, a, b, F3, K3, M(x, 58));
R(b, c, d, e, a, F3, K3, M(x, 59));
R(a, b, c, d, e, F4, K4, M(x, 60));
R(e, a, b, c, d, F4, K4, M(x, 61));
R(d, e, a, b, c, F4, K4, M(x, 62));
R(c, d, e, a, b, F4, K4, M(x, 63));
R(b, c, d, e, a, F4, K4, M(x, 64));
R(a, b, c, d, e, F4, K4, M(x, 65));
R(e, a, b, c, d, F4, K4, M(x, 66));
R(d, e, a, b, c, F4, K4, M(x, 67));
R(c, d, e, a, b, F4, K4, M(x, 68));
R(b, c, d, e, a, F4, K4, M(x, 69));
R(a, b, c, d, e, F4, K4, M(x, 70));
R(e, a, b, c, d, F4, K4, M(x, 71));
R(d, e, a, b, c, F4, K4, M(x, 72));
R(c, d, e, a, b, F4, K4, M(x, 73));
R(b, c, d, e, a, F4, K4, M(x, 74));
R(a, b, c, d, e, F4, K4, M(x, 75));
R(e, a, b, c, d, F4, K4, M(x, 76));
R(d, e, a, b, c, F4, K4, M(x, 77));
R(c, d, e, a, b, F4, K4, M(x, 78));
R(b, c, d, e, a, F4, K4, M(x, 79));
